<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå‡∏á‡∏≤‡∏ô</title>
  <link href="https://fonts.googleapis.com/css2?family=K2D:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
  <style>
    :root {
      --primary-color: #2E7D32;
      --secondary-color: #E8F5E8;
      --white: #FFFFFF;
      --text-color: #333333;
      --border-color: #2E7D32;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'K2D', sans-serif;
    }
    
    body {
      background-color: var(--secondary-color);
      color: var(--text-color);
      line-height: 1.6;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    header {
      background-color: var(--white);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      border: 2px solid var(--border-color);
      text-align: center;
    }
    
    .logo {
      width: 100px;
      height: auto;
      margin-bottom: 10px;
    }
    
    h1 {
      color: var(--primary-color);
      font-size: 24px;
    }
    
    .tabs {
      display: flex;
      margin-bottom: 20px;
      background-color: var(--white);
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      border: 2px solid var(--border-color);
    }
    
    .tab {
      flex: 1;
      text-align: center;
      padding: 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
    }
    
    .tab:hover {
      background-color: var(--secondary-color);
    }
    
    .tab.active {
      background-color: var(--primary-color);
      color: var(--white);
    }
    
    .tab-content {
      display: none;
      background-color: var(--white);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      border: 2px solid var(--border-color);
    }
    
    .tab-content.active {
      display: block;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }
    
    input, select, textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 16px;
    }
    
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--primary-color);
    }
    
    .btn {
      background-color: var(--primary-color);
      color: var(--white);
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.3s;
    }
    
    .btn:hover {
      background-color: #1B5E20;
    }
    
    .file-upload {
      border: 2px dashed #ddd;
      padding: 20px;
      text-align: center;
      border-radius: 5px;
      margin-bottom: 15px;
    }
    
    .file-upload.active {
      border-color: var(--primary-color);
    }
    
    .file-preview {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 15px;
    }
    
    .file-preview-item {
      width: 100px;
      height: 100px;
      position: relative;
      border: 1px solid #ddd;
      border-radius: 5px;
      overflow: hidden;
    }
    
    .file-preview-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .file-preview-item .remove-file {
      position: absolute;
      top: 5px;
      right: 5px;
      background-color: rgba(0, 0, 0, 0.5);
      color: white;
      border: none;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    
    .progress-container {
      width: 100%;
      background-color: #f1f1f1;
      border-radius: 5px;
      margin: 15px 0;
      display: none;
    }
    
    .progress-bar {
      height: 20px;
      background-color: var(--primary-color);
      border-radius: 5px;
      width: 0%;
      transition: width 0.3s;
      text-align: center;
      color: white;
      font-size: 12px;
      line-height: 20px;
    }
    
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      display: none;
    }
    
    .loading-spinner {
      border: 5px solid #f3f3f3;
      border-top: 5px solid var(--primary-color);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .stats-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .stat-card {
      background-color: var(--white);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      border: 2px solid var(--border-color);
      text-align: center;
    }
    
    .stat-card h3 {
      color: var(--primary-color);
      margin-bottom: 10px;
    }
    
    .stat-card .stat-value {
      font-size: 24px;
      font-weight: bold;
    }
    
    .chart-container {
      background-color: var(--white);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      border: 2px solid var(--border-color);
      margin-bottom: 20px;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    
    table, th, td {
      border: 1px solid #ddd;
    }
    
    th, td {
      padding: 12px;
      text-align: left;
    }
    
    th {
      background-color: var(--primary-color);
      color: var(--white);
    }
    
    tr:nth-child(even) {
      background-color: #f2f2f2;
    }
    
    .action-btn {
      padding: 5px 10px;
      margin-right: 5px;
      border: none;
      border-radius: 3px;
      cursor: pointer;
    }
    
    .edit-btn {
      background-color: #2196F3;
      color: white;
    }
    
    .delete-btn {
      background-color: #f44336;
      color: white;
    }
    
    .thumbnail-img {
      width: 50px;
      height: 50px;
      object-fit: cover;
      border-radius: 5px;
    }
    
    .pdpa-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    
    .pdpa-content {
      background-color: var(--white);
      padding: 30px;
      border-radius: 10px;
      max-width: 600px;
      max-height: 80vh;
      overflow-y: auto;
      border: 2px solid var(--border-color);
    }
    
    .pdpa-content h2 {
      color: var(--primary-color);
      margin-bottom: 15px;
      text-align: center;
    }
    
    .pdpa-content p {
      margin-bottom: 15px;
    }
    
    .pdpa-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 20px;
    }
    
    @media (max-width: 768px) {
      .tabs {
        flex-direction: column;
      }
      
      .tab {
        padding: 10px;
      }
      
      .stats-container {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- PDPA Modal -->
  <div class="pdpa-modal" id="pdpaModal">
    <div class="pdpa-content" >
      <center>
      <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgP7650FTCSeNQU8DBnHv7w0lL7CxVLmv_vLJ4tE9vcPbILI9KNeTqAUnmPg6ELY-qyt5BLKSAuaQILMr6gyYiWqF8HToyRnYiks86ESHapld6XUGvp0wGfuGYyvra18zjhZN1afCwQ66ZvMxxaoS3ACz0zbe6d07GuYNWd7xFGPZZjI5tTLSiyOkifsqAh/s1600/sesapylogo.png" alt="Logo" class="logo">
      </center>
      <h2>‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</h2>
      <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏¢‡πà‡∏≠ ‡πÅ‡∏•‡∏∞‡∏£‡∏π‡∏õ‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡πÉ‡∏à ‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏≤‡∏°‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏ä‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• ‡∏û.‡∏®. 2562 (PDPA)</p>
      <p>‡πÄ‡∏£‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÇ‡∏î‡∏¢‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡∏à‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì</p>
      <p>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏≠‡∏≤‡∏à‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á:</p>
      <ul>
        <li>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</li>
        <li>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô</li>
        <li>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (‡∏≠‡∏µ‡πÄ‡∏°‡∏•, ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå)</li>
        <li>‡πÑ‡∏ü‡∏•‡πå‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î</li>
      </ul>
      <p>‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Ç‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏•‡∏ö ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡∏Å‡∏ñ‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠</p>
      <div class="pdpa-buttons">
        <button class="btn" id="pdpaAgree">‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°</button>
        <button class="btn" style="background-color: #f44336;" id="pdpaDisagree">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
      </div>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner"></div>
  </div>

  <div class="container">
    <header>
      <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgP7650FTCSeNQU8DBnHv7w0lL7CxVLmv_vLJ4tE9vcPbILI9KNeTqAUnmPg6ELY-qyt5BLKSAuaQILMr6gyYiWqF8HToyRnYiks86ESHapld6XUGvp0wGfuGYyvra18zjhZN1afCwQ66ZvMxxaoS3ACz0zbe6d07GuYNWd7xFGPZZjI5tTLSiyOkifsqAh/s1600/sesapylogo.png" alt="Logo" class="logo"> 
      <h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏¢‡πà‡∏≠ ‡πÅ‡∏•‡∏∞‡∏£‡∏π‡∏õ‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡πÉ‡∏à</h1>
    </header>
    
    <div class="tabs">
      <div class="tab active" data-tab="tab1">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• üìù</div>
      <div class="tab" data-tab="tab2">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î üìä</div>
      <div class="tab" data-tab="tab3">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• üõ†Ô∏è</div>
      <div class="tab" data-tab="tab4">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• üñºÔ∏è</div>      
    </div>
    
    <!-- Tab 1: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
    <div class="tab-content active" id="tab1">
      <form id="uploadForm">
        <div class="form-group">
          <label for="submissionDate">‡∏ß‡∏±‡∏ô ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏õ‡∏µ ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á</label>
          <input type="date" id="submissionDate" name="submissionDate" required>
        </div>
        
        <div class="form-group">
          <label for="fullName">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</label>
          <input type="text" id="fullName" name="fullName" required>
        </div>
        
        <div class="form-group">
          <label for="position">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
          <select id="position" name="position" required>
            <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á --</option>
            <option value="‡∏Ñ‡∏£‡∏π">‡∏Ñ‡∏£‡∏π</option>
            <option value="‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô">‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
            <option value="‡∏£‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô">‡∏£‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>    
          </select>
        </div>
        
        <div class="form-group">
          <label for="academicRank">‡∏ß‡∏¥‡∏ó‡∏¢‡∏ê‡∏≤‡∏ô‡∏∞</label>
          <select id="academicRank" name="academicRank">
            <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ó‡∏¢‡∏ê‡∏≤‡∏ô‡∏∞ --</option>
            <option value="‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç‡∏Å‡∏≤‡∏£">‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç‡∏Å‡∏≤‡∏£</option>
            <option value="‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡πÄ‡∏®‡∏©">‡∏ä‡∏≥‡∏ô‡∏≤‡∏ç‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡πÄ‡∏®‡∏©</option>
            <option value="‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç">‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç</option>
            <option value="‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏û‡∏¥‡πÄ‡∏®‡∏©">‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏û‡∏¥‡πÄ‡∏®‡∏©</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="school">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
          <select id="school" name="school" required>
            <option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô --</option>
            <option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏∞‡πÄ‡∏¢‡∏≤‡∏û‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏∞‡πÄ‡∏¢‡∏≤‡∏û‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°</option>
<option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ü‡∏≤‡∏Å‡∏Å‡∏ß‡πä‡∏≤‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ü‡∏≤‡∏Å‡∏Å‡∏ß‡πä‡∏≤‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°</option>
<option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏∞‡πÄ‡∏¢‡∏≤‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ò‡∏ô‡πå‡∏ß‡∏¥‡∏ó‡∏¢‡πå">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏∞‡πÄ‡∏¢‡∏≤‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ò‡∏ô‡πå‡∏ß‡∏¥‡∏ó‡∏¢‡πå</option>
<option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏à‡∏∏‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏à‡∏∏‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°</option>
<option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏ç‡∏≤‡∏•‡∏≠‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏ç‡∏≤‡∏•‡∏≠‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°</option>
<option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏Ñ‡∏≥‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏Ñ‡∏≥‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°</option>
<option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ù‡∏≤‡∏¢‡∏Å‡∏ß‡∏≤‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ù‡∏≤‡∏¢‡∏Å‡∏ß‡∏≤‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°</option>
<option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏°‡πà‡∏ß‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏°‡πà‡∏ß‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°</option>
<option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏î‡∏≠‡∏Å‡∏Ñ‡∏≥‡πÉ‡∏ï‡πâ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏î‡∏≠‡∏Å‡∏Ñ‡∏≥‡πÉ‡∏ï‡πâ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°</option>
<option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ñ‡πâ‡∏≥‡∏õ‡∏¥‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ñ‡πâ‡∏≥‡∏õ‡∏¥‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°</option>
<option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏á‡∏≥‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏á‡∏≥‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°</option>
<option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏á‡∏£‡∏±‡∏ä‡∏î‡∏≤‡∏†‡∏¥‡πÄ‡∏©‡∏Å">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏á‡∏£‡∏±‡∏ä‡∏î‡∏≤‡∏†‡∏¥‡πÄ‡∏©‡∏Å</option>
<option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°</option>
<option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ç‡∏∏‡∏ô‡∏Ñ‡∏ß‡∏£‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ç‡∏∏‡∏ô‡∏Ñ‡∏ß‡∏£‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°</option>
<option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏°‡πà‡πÉ‡∏à‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏°‡πà‡πÉ‡∏à‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°</option>
<option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏†‡∏π‡∏ã‡∏≤‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏†‡∏π‡∏ã‡∏≤‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°</option>
<option value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏î‡∏á‡πÄ‡∏à‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏î‡∏á‡πÄ‡∏à‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°</option>

          </select>
        </div>
        
        <div class="form-group">
          <label for="email">‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á</label>
          <input type="email" id="email" name="email" required>
        </div>
        
        <div class="form-group">
          <label for="phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
          <input type="tel" id="phone" name="phone" pattern="[0-9]{10}" required>
        </div>
        
        <div class="form-group">
          <label for="additionalInfo">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label>
          <textarea id="additionalInfo" name="additionalInfo" rows="3"></textarea>
        </div>
        
        <div class="form-group">
          <label for="status">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á</label>
          <select id="status" name="status">
            <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</option>
            <option value="‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>‡πÑ‡∏ü‡∏•‡πå‡∏á‡∏≤‡∏ô (PDF, DOC, DOCX, XLS, XLSX, JPG, JPEG, PNG)</label>
          <div class="file-upload" id="fileUploadArea">
            <p>‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå</p>
            <p>‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 15 ‡πÑ‡∏ü‡∏•‡πå (‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏ß‡∏°‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 20MB)</p>
            <input type="file" id="fileInput" multiple style="display: none;" accept=".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png">
          </div>
          <div class="file-preview" id="filePreview"></div>
        </div>
        
        <div class="progress-container" id="progressContainer">
          <div class="progress-bar" id="progressBar">0%</div>
        </div>
        
        <button type="submit" class="btn" id="submitBtn">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
      </form>
    </div>
    
    <!-- Tab 2: ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î -->
    <div class="tab-content" id="tab2">
      <div class="stats-container">
        <div class="stat-card">
          <h3>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î</h3>
          <div class="stat-value" id="totalUploaders">0</div>
        </div>
        <div class="stat-card">
          <h3>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏∑‡πà‡∏≠</h3>
          <div class="stat-value" id="totalFiles">0</div>
        </div>
        <div class="stat-card">
          <h3>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</h3>
          <div class="stat-value" id="totalMessages">0</div>
        </div>
      </div>
      
      <div class="chart-container">
        <h3>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏≤‡∏°‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
        <canvas id="schoolChart"></canvas>
      </div>
      
      <div class="chart-container">
        <h3>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏≤‡∏°‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</h3>
        <canvas id="positionChart"></canvas>
      </div>
      
      <h3>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
      <table id="recentSubmissions">
        <thead>
          <tr>
            <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á</th>
            <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th>
            <th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th>
            <th>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
            <th>‡∏†‡∏≤‡∏û‡∏¢‡πà‡∏≠</th>
          </tr>
        </thead>
        <tbody>
          <!-- Data will be loaded here -->
        </tbody>
      </table>
    </div>
    
    <!-- Tab 3: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
    <div class="tab-content" id="tab3">
      <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á</h3>
      <table id="dataTable">
        <thead>
          <tr>
            <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á</th>
            <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th>
            <th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th>
            <th>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
            <th>‡∏†‡∏≤‡∏û‡∏¢‡πà‡∏≠</th>
            <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
          </tr>
        </thead>
        <tbody>
          <!-- Data will be loaded here -->
        </tbody>
      </table>
      
      <div style="margin-top: 20px;">
        <button class="btn" id="printReportBtn">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
      </div>
    </div>
        <!-- Tab 4: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
    <div class="tab-content" id="tab4">
      <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á</h3>
      <div style="border-radius: 8px; box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px; margin: auto; max-width: 100%; overflow: hidden; text-align: center;">
  <iframe src="https://developmentsesapy.github.io/Retireeinfo/show.html" style="border: 0; height: 1500px; width: 100%;">
  </iframe>
</div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // PDPA Modal
    document.addEventListener('DOMContentLoaded', function() {
      const pdpaModal = document.getElementById('pdpaModal');
      const pdpaAgree = document.getElementById('pdpaAgree');
      const pdpaDisagree = document.getElementById('pdpaDisagree');
      
      // Check if user has already agreed to PDPA
      if (!localStorage.getItem('pdpaAgreed')) {
        pdpaModal.style.display = 'flex';
      } else {
        pdpaModal.style.display = 'none';
      }
      
      // Handle agreement
      pdpaAgree.addEventListener('click', function() {
        localStorage.setItem('pdpaAgreed', 'true');
        pdpaModal.style.display = 'none';
      });
      
      // Handle disagreement
      pdpaDisagree.addEventListener('click', function() {
        Swal.fire({
          title: '‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô',
          text: '‡∏Ñ‡∏∏‡∏ì‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö',
          icon: 'warning',
          confirmButtonText: '‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß'
        }).then(() => {
          pdpaModal.style.display = 'flex';
        });
      });
      
      // Tab switching
      const tabs = document.querySelectorAll('.tab');
      tabs.forEach(tab => {
        tab.addEventListener('click', function() {
          // Remove active class from all tabs and tab contents
          tabs.forEach(t => t.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(content => {
            content.classList.remove('active');
          });
          
          // Add active class to clicked tab and corresponding content
          this.classList.add('active');
          const tabId = this.getAttribute('data-tab');
          document.getElementById(tabId).classList.add('active');
          
          // Load data when switching to stats or management tabs
          if (tabId === 'tab2') {
            loadStatistics();
          } else if (tabId === 'tab3') {
            loadDataTable();
          }
        });
      });
      
      // File upload handling
      const fileUploadArea = document.getElementById('fileUploadArea');
      const fileInput = document.getElementById('fileInput');
      const filePreview = document.getElementById('filePreview');
      let files = [];
      
      // Handle click on upload area
      fileUploadArea.addEventListener('click', function() {
        fileInput.click();
      });
      
      // Handle file selection
      fileInput.addEventListener('change', function(e) {
        handleFiles(e.target.files);
      });
      
      // Handle drag and drop
      fileUploadArea.addEventListener('dragover', function(e) {
        e.preventDefault();
        this.classList.add('active');
      });
      
      fileUploadArea.addEventListener('dragleave', function() {
        this.classList.remove('active');
      });
      
      fileUploadArea.addEventListener('drop', function(e) {
        e.preventDefault();
        this.classList.remove('active');
        handleFiles(e.dataTransfer.files);
      });
      
      function handleFiles(newFiles) {
        // Check total file count
        if (files.length + newFiles.length > 15) {
          Swal.fire({
            title: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            text: '‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 15 ‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πà‡∏≠‡∏Ñ‡∏£‡∏±‡πâ‡∏á',
            icon: 'error'
          });
          return;
        }
        
        // Check total file size
        let totalSize = files.reduce((sum, file) => sum + file.size, 0);
        for (let i = 0; i < newFiles.length; i++) {
          totalSize += newFiles[i].size;
        }
        
        if (totalSize > 20 * 1024 * 1024) { // 20MB
          Swal.fire({
            title: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            text: '‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏ß‡∏°‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 20MB',
            icon: 'error'
          });
          return;
        }
        
        // Add new files to array
        files = [...files, ...Array.from(newFiles)];
        updateFilePreview();
      }
      
      function updateFilePreview() {
        filePreview.innerHTML = '';
        
        files.forEach((file, index) => {
          const fileItem = document.createElement('div');
          fileItem.className = 'file-preview-item';
          
          if (file.type.startsWith('image/')) {
            const img = document.createElement('img');
            img.src = URL.createObjectURL(file);
            fileItem.appendChild(img);
          } else {
            const fileIcon = document.createElement('div');
            fileIcon.style.display = 'flex';
            fileIcon.style.flexDirection = 'column';
            fileIcon.style.alignItems = 'center';
            fileIcon.style.justifyContent = 'center';
            fileIcon.style.height = '100%';
            fileIcon.style.padding = '10px';
            
            const icon = document.createElement('i');
            if (file.type.includes('pdf')) {
              icon.className = 'fas fa-file-pdf';
              icon.style.color = '#FF0000';
              icon.style.fontSize = '24px';
            } else if (file.type.includes('word') || file.type.includes('document')) {
              icon.className = 'fas fa-file-word';
              icon.style.color = '#2B579A';
              icon.style.fontSize = '24px';
            } else if (file.type.includes('excel') || file.type.includes('spreadsheet')) {
              icon.className = 'fas fa-file-excel';
              icon.style.color = '#217346';
              icon.style.fontSize = '24px';
            } else {
              icon.className = 'fas fa-file';
              icon.style.fontSize = '24px';
            }
            
            const fileName = document.createElement('span');
            fileName.textContent = file.name.length > 15 ? file.name.substring(0, 12) + '...' : file.name;
            fileName.style.fontSize = '12px';
            fileName.style.marginTop = '5px';
            fileName.style.textAlign = 'center';
            fileName.style.wordBreak = 'break-all';
            
            fileIcon.appendChild(icon);
            fileIcon.appendChild(fileName);
            fileItem.appendChild(fileIcon);
          }
          
          const removeBtn = document.createElement('button');
          removeBtn.className = 'remove-file';
          removeBtn.innerHTML = '&times;';
          removeBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            files.splice(index, 1);
            updateFilePreview();
          });
          
          fileItem.appendChild(removeBtn);
          filePreview.appendChild(fileItem);
        });
      }
      
      // Form submission
      const uploadForm = document.getElementById('uploadForm');
      const loadingOverlay = document.getElementById('loadingOverlay');
      const progressContainer = document.getElementById('progressContainer');
      const progressBar = document.getElementById('progressBar');
      
      uploadForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Validate form
        if (!validateForm()) {
          return;
        }
        
        // Show loading
        loadingOverlay.style.display = 'flex';
        progressContainer.style.display = 'block';
        
        // Prepare form data
        const formData = {
          submissionDate: document.getElementById('submissionDate').value,
          fullName: document.getElementById('fullName').value,
          position: document.getElementById('position').value,
          academicRank: document.getElementById('academicRank').value,
          school: document.getElementById('school').value,
          email: document.getElementById('email').value,
          phone: document.getElementById('phone').value,
          additionalInfo: document.getElementById('additionalInfo').value,
          status: document.getElementById('status').value,
          files: []
        };
        
        // Process files if any
        if (files.length > 0) {
          const fileReaders = [];
          
          files.forEach((file, index) => {
            const reader = new FileReader();
            fileReaders.push(reader);
            
            reader.onload = function(e) {
              formData.files.push({
                name: file.name,
                type: file.type,
                data: e.target.result.split(',')[1] // Remove data URL prefix
              });
              
              // Update progress
              const progress = Math.round(((index + 1) / files.length) * 100);
              progressBar.style.width = `${progress}%`;
              progressBar.textContent = `${progress}%`;
              
              // When all files are read, submit the form
              if (formData.files.length === files.length) {
                submitForm(formData);
              }
            };
            
            reader.readAsDataURL(file);
          });
        } else {
          submitForm(formData);
        }
      });
      
      function validateForm() {
        const fullName = document.getElementById('fullName').value;
        const position = document.getElementById('position').value;
        const school = document.getElementById('school').value;
        const email = document.getElementById('email').value;
        const phone = document.getElementById('phone').value;
        
        if (!fullName) {
          Swal.fire({
            title: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•',
            icon: 'error'
          });
          return false;
        }
        
        if (!position) {
          Swal.fire({
            title: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á',
            icon: 'error'
          });
          return false;
        }
        
        if (!school) {
          Swal.fire({
            title: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô',
            icon: 'error'
          });
          return false;
        }
        
        if (!email) {
          Swal.fire({
            title: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•',
            icon: 'error'
          });
          return false;
        }
        
        if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
          Swal.fire({
            title: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            text: '‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á',
            icon: 'error'
          });
          return false;
        }
        
        if (!phone) {
          Swal.fire({
            title: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå',
            icon: 'error'
          });
          return false;
        }
        
        if (!/^[0-9]{10}$/.test(phone)) {
          Swal.fire({
            title: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            text: '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 10 ‡∏´‡∏•‡∏±‡∏Å',
            icon: 'error'
          });
          return false;
        }
        
        return true;
      }
      
      function submitForm(formData) {
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxL3uYFaFOy9l56fkyc3FTjtgFu-RwjdqwstTKvgrxkgCAx0IF66--UUUAyNmRUB5TNCg/exec';
        
        fetch(SCRIPT_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'text/plain'
          },
          body: JSON.stringify(formData)
        })
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => {
          loadingOverlay.style.display = 'none';
          
          if (data.success) {
            Swal.fire({
              title: '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
              text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
              icon: 'success'
            }).then(() => {
              // Reset form
              uploadForm.reset();
              files = [];
              updateFilePreview();
              progressContainer.style.display = 'none';
              progressBar.style.width = '0%';
              progressBar.textContent = '0%';
              
              // Reload statistics if on that tab
              if (document.getElementById('tab2').classList.contains('active')) {
                loadStatistics();
              }
              
              // Reload data table if on that tab
              if (document.getElementById('tab3').classList.contains('active')) {
                loadDataTable();
              }
            });
          } else {
            Swal.fire({
              title: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
              text: data.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
              icon: 'error'
            });
          }
        })
        .catch(error => {
          loadingOverlay.style.display = 'none';
          Swal.fire({
            title: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            text: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠: ' + error.message,
            icon: 'error'
          });
        });
      }
      
      // Load statistics
      function loadStatistics() {
        showLoading();
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxL3uYFaFOy9l56fkyc3FTjtgFu-RwjdqwstTKvgrxkgCAx0IF66--UUUAyNmRUB5TNCg/exec?action=getStats';
        
        fetch(SCRIPT_URL)
          .then(response => {
            if (!response.ok) {
              throw new Error('Network response was not ok');
            }
            return response.json();
          })
          .then(data => {
            hideLoading();
            if (data && data.success) {
              // Update stats cards
              document.getElementById('totalUploaders').textContent = data.totalUploaders || 0;
              document.getElementById('totalFiles').textContent = data.totalFiles || 0;
              document.getElementById('totalMessages').textContent = data.totalMessages || 0;
              
              // Update recent submissions table
              const recentTableBody = document.querySelector('#recentSubmissions tbody');
              recentTableBody.innerHTML = '';
              
              if (data.recentSubmissions && data.recentSubmissions.length > 0) {
                data.recentSubmissions.forEach(submission => {
                  const row = document.createElement('tr');
                  row.innerHTML = `
                    <td>${submission.date || '-'}</td>
                    <td>${submission.name || '-'}</td>
                    <td>${submission.position || '-'}</td>
                    <td>${submission.school || '-'}</td>
                    <td>${submission.status || '-'}</td>
                    <td>${
                      submission.thumbnail 
                        ? `<img src="${submission.thumbnail}" class="thumbnail-img" alt="‡∏†‡∏≤‡∏û‡∏¢‡πà‡∏≠">` 
                        : '-'
                    }</td>
                  `;
                  recentTableBody.appendChild(row);
                });
              } else {
                recentTableBody.innerHTML = '<tr><td colspan="6" style="text-align: center;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
              }
              
              // Create charts if data exists
              if (data.chartData) {
                createCharts(data.chartData);
              }
            } else {
              showError('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÑ‡∏î‡πâ: ' + (data ? data.message : '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'));
            }
          })
          .catch(error => {
            hideLoading();
            showError('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥: ' + error.message);
          });
      }
      
      // Create charts
      function createCharts(chartData) {
        try {
          // School chart (bar chart)
          const schoolCtx = document.getElementById('schoolChart').getContext('2d');
          if (window.schoolChart) {
            window.schoolChart.destroy();
          }
          
          if (chartData.schools && chartData.schools.length > 0) {
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏Å‡πÑ‡∏õ‡∏ô‡πâ‡∏≠‡∏¢
            const sortedSchools = [...chartData.schools].sort((a, b) => b.count - a.count);
            
            window.schoolChart = new Chart(schoolCtx, {
              type: 'bar',
              data: {
                labels: sortedSchools.map(item => item.school || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'),
                datasets: [{
                  label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á',
                  data: sortedSchools.map(item => item.count || 0),
                  backgroundColor: '#2E7D32',
                  borderColor: '#1B5E20',
                  borderWidth: 1
                }]
              },
              options: {
                responsive: true,
                scales: {
                  y: {
                    beginAtZero: true,
                    ticks: {
                      stepSize: 1
                    }
                  },
                  x: {
                    ticks: {
                      autoSkip: false,
                      maxRotation: 45,
                      minRotation: 45
                    }
                  }
                },
                animation: {
                  duration: 1000
                }
              }
            });
          } else {
            schoolCtx.canvas.parentNode.innerHTML = '<p>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>';
          }
          
          // Position chart (pie chart)
          const positionCtx = document.getElementById('positionChart').getContext('2d');
          if (window.positionChart) {
            window.positionChart.destroy();
          }
          
          if (chartData.positions && chartData.positions.length > 0) {
            window.positionChart = new Chart(positionCtx, {
              type: 'pie',
              data: {
                labels: chartData.positions.map(item => item.position || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'),
                datasets: [{
                  label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á',
                  data: chartData.positions.map(item => item.count || 0),
                  backgroundColor: [
                    '#2E7D32',
                    '#4CAF50',
                    '#81C784',
                    '#A5D6A7',
                    '#C8E6C9',
                    '#E8F5E9'
                  ],
                  borderWidth: 1
                }]
              },
              options: {
                responsive: true,
                plugins: {
                  legend: {
                    position: 'right',
                  },
                  tooltip: {
                    callbacks: {
                      label: function(context) {
                        const label = context.label || '';
                        const value = context.raw || 0;
                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                        const percentage = Math.round((value / total) * 100);
                        return `${label}: ${value} (${percentage}%)`;
                      }
                    }
                  }
                },
                animation: {
                  duration: 1000
                }
              }
            });
          } else {
            positionCtx.canvas.parentNode.innerHTML = '<p>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</p>';
          }
        } catch (error) {
          console.error('Error creating charts:', error);
        }
      }
      
      // Load data table for management
      function loadDataTable() {
        showLoading();
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxL3uYFaFOy9l56fkyc3FTjtgFu-RwjdqwstTKvgrxkgCAx0IF66--UUUAyNmRUB5TNCg/exec?action=getAllData';
        
        fetch(SCRIPT_URL)
          .then(response => {
            if (!response.ok) {
              throw new Error('Network response was not ok');
            }
            return response.json();
          })
          .then(data => {
            hideLoading();
            if (data && data.success) {
              const tableBody = document.querySelector('#dataTable tbody');
              tableBody.innerHTML = '';
              
              if (data.submissions && data.submissions.length > 0) {
                data.submissions.forEach(submission => {
                  const row = document.createElement('tr');
                  row.innerHTML = `
                    <td>${submission.date || '-'}</td>
                    <td>${submission.name || '-'}</td>
                    <td>${submission.position || '-'}</td>
                    <td>${submission.school || '-'}</td>
                    <td>${submission.status || '-'}</td>
                    <td>${
                      submission.thumbnail 
                        ? `<img src="${submission.thumbnail}" class="thumbnail-img" alt="‡∏†‡∏≤‡∏û‡∏¢‡πà‡∏≠">` 
                        : '-'
                    }</td>
                    <td>
                      <button class="action-btn edit-btn" data-id="${submission.id || ''}"><i class="fas fa-edit"></i></button>
                      <button class="action-btn delete-btn" data-id="${submission.id || ''}"><i class="fas fa-trash"></i></button>
                    </td>
                  `;
                  tableBody.appendChild(row);
                });
                
                // Add event listeners to action buttons
                document.querySelectorAll('.edit-btn').forEach(btn => {
                  btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    editSubmission(id);
                  });
                });
                
                document.querySelectorAll('.delete-btn').forEach(btn => {
                  btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    deleteSubmission(id);
                  });
                });
              } else {
                tableBody.innerHTML = '<tr><td colspan="7" style="text-align: center;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
              }
            } else {
              showError('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ: ' + (data ? data.message : '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'));
            }
          })
          .catch(error => {
            hideLoading();
            showError('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ' + error.message);
          });
      }
      
      // Edit submission
      function editSubmission(id) {
        Swal.fire({
          title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
          allowOutsideClick: false,
          didOpen: () => {
            Swal.showLoading();
          }
        });
        
        const SCRIPT_URL = `https://script.google.com/macros/s/AKfycbxL3uYFaFOy9l56fkyc3FTjtgFu-RwjdqwstTKvgrxkgCAx0IF66--UUUAyNmRUB5TNCg/exec?action=getSubmission&id=${id}`;
        
        fetch(SCRIPT_URL)
          .then(response => {
            if (!response.ok) {
              throw new Error('Network response was not ok');
            }
            return response.json();
          })
          .then(data => {
            Swal.close();
            
            if (data && data.success) {
              const submission = data.submission;
              
              Swal.fire({
                title: '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                html: `
                  <div class="form-group">
                    <label for="editStatus">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                    <select id="editStatus" class="swal2-input">
                      <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö" ${submission.status === '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö' ? 'selected' : ''}>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</option>
                      <option value="‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß" ${submission.status === '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß' ? 'selected' : ''}>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß</option>
                    </select>
                  </div>
                  <div class="form-group" style="margin-top: 15px;">
                    <label for="editPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</label>
                    <input type="password" id="editPassword" class="swal2-input" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" required>
                  </div>
                `,
                showCancelButton: true,
                confirmButtonText: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å',
                cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
                preConfirm: () => {
                  const password = document.getElementById('editPassword').value;
                  if (!password) {
                    Swal.showValidationMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô');
                    return false;
                  }
                  return {
                    status: document.getElementById('editStatus').value,
                    password: password
                  };
                }
              }).then(result => {
                if (result.isConfirmed) {
                  updateSubmission(id, result.value);
                }
              });
            } else {
              showError(data ? data.message : '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ');
            }
          })
          .catch(error => {
            Swal.close();
            showError('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠: ' + error.message);
          });
      }
      
      function updateSubmission(id, data) {
        showLoading();
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxL3uYFaFOy9l56fkyc3FTjtgFu-RwjdqwstTKvgrxkgCAx0IF66--UUUAyNmRUB5TNCg/exec';
        
        fetch(SCRIPT_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'text/plain'
          },
          body: JSON.stringify({
            action: 'updateSubmission',
            id: id,
            status: data.status,
            password: data.password
          })
        })
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => {
          hideLoading();
          if (data && data.success) {
            Swal.fire({
              title: '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
              text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
              icon: 'success'
            }).then(() => {
              loadDataTable();
            });
          } else {
            showError(data ? data.message : '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
          }
        })
        .catch(error => {
          hideLoading();
          showError('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠: ' + error.message);
        });
      }
      
      // Delete submission
      function deleteSubmission(id) {
        Swal.fire({
          title: '‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?',
          text: "‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ!",
          icon: 'warning',
          showCancelButton: true,
          confirmButtonColor: '#2E7D32',
          cancelButtonColor: '#d33',
          confirmButtonText: '‡πÉ‡∏ä‡πà, ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•!',
          cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
          html: `
            <div class="form-group" style="margin-top: 15px;">
              <label for="deletePassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</label>
              <input type="password" id="deletePassword" class="swal2-input" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" required>
            </div>
          `,
          preConfirm: () => {
            const password = document.getElementById('deletePassword').value;
            if (!password) {
              Swal.showValidationMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô');
              return false;
            }
            return password;
          }
        }).then((result) => {
          if (result.isConfirmed) {
            const password = result.value;
            showLoading();
            const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxL3uYFaFOy9l56fkyc3FTjtgFu-RwjdqwstTKvgrxkgCAx0IF66--UUUAyNmRUB5TNCg/exec';
            
            fetch(SCRIPT_URL, {
              method: 'POST',
              headers: {
                'Content-Type': 'text/plain'
              },
              body: JSON.stringify({
                action: 'deleteSubmission',
                id: id,
                password: password
              })
            })
            .then(response => {
              if (!response.ok) {
                throw new Error('Network response was not ok');
              }
              return response.json();
            })
            .then(data => {
              hideLoading();
              if (data && data.success) {
                Swal.fire(
                  '‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß!',
                  '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
                  'success'
                ).then(() => {
                  loadDataTable();
                });
              } else {
                showError(data ? data.message : '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
              }
            })
            .catch(error => {
              hideLoading();
              showError('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠: ' + error.message);
            });
          }
        });
      }
      
      // Print report
      document.getElementById('printReportBtn').addEventListener('click', function() {
        window.print();
      });
      
      // Helper functions
      function showLoading() {
        document.getElementById('loadingOverlay').style.display = 'flex';
      }
      
      function hideLoading() {
        document.getElementById('loadingOverlay').style.display = 'none';
      }
      
      function showError(message) {
        Swal.fire({
          title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
          text: message,
          icon: 'error'
        });
      }
      
      // Set current date as default
      const today = new Date();
      const formattedDate = today.toISOString().substr(0, 10);
      document.getElementById('submissionDate').value = formattedDate;
      
      // Load statistics if on that tab initially
      if (document.getElementById('tab2').classList.contains('active')) {
        loadStatistics();
      }
      
      // Load data table if on that tab initially
      if (document.getElementById('tab3').classList.contains('active')) {
        loadDataTable();
      }
    });
  </script>
</body>
</html>
